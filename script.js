const detailedContent = {
  primaria: {
    subatomico: {
    title: "Estructura SubatÃ³mica",
    subtitle: "Nivel secundario y universitario",
    content: `
      Los Ã¡tomos no son indivisibles: estÃ¡n formados por partÃ­culas aÃºn mÃ¡s pequeÃ±as llamadas protones, neutrones y electrones. 
      El nÃºcleo atÃ³mico (protones y neutrones) concentra casi toda la masa, mientras que los electrones giran a gran velocidad en la corteza. 
      A nivel mÃ¡s profundo, los protones y neutrones estÃ¡n compuestos por quarks, mantenidos unidos por gluones. 
      Este nivel explica fenÃ³menos como la radiactividad, la espectroscopÃ­a y la energÃ­a nuclear.
    `,
    examples: [
      "El electrÃ³n tiene carga negativa y masa casi nula",
      "El protÃ³n tiene carga positiva y masa similar a la del neutrÃ³n",
      "El neutrÃ³n es elÃ©ctricamente neutro pero fundamental en la estabilidad nuclear",
      "El Ã¡tomo de uranio se utiliza en reactores nucleares por su inestabilidad",
    ],
    curiosities: [
      "MÃ¡s del 99% de la masa del Ã¡tomo estÃ¡ en el nÃºcleo",
      "Los quarks nunca existen solos, siempre en grupos",
      "El modelo atÃ³mico ha evolucionado desde Dalton hasta el modelo cuÃ¡ntico actual",
    ],
  },

  molecular: {
    title: "OrganizaciÃ³n Molecular",
    subtitle: "Nivel secundario y universitario",
    content: `
      Cuando los Ã¡tomos se unen mediante enlaces quÃ­micos, forman molÃ©culas. 
      Pueden ser pequeÃ±as como el oxÃ­geno (Oâ‚‚) o muy complejas como las proteÃ­nas. 
      La estructura tridimensional de una molÃ©cula determina sus propiedades fÃ­sicas y quÃ­micas. 
      Las molÃ©culas orgÃ¡nicas son la base de la vida, y las inorgÃ¡nicas permiten el funcionamiento de los sistemas naturales y tecnolÃ³gicos.
    `,
    examples: [
      "El agua (Hâ‚‚O) regula la temperatura de los seres vivos y es solvente universal",
      "La glucosa (Câ‚†Hâ‚â‚‚Oâ‚†) es la fuente primaria de energÃ­a en organismos",
      "El ADN y ARN son macromolÃ©culas que almacenan y transmiten informaciÃ³n genÃ©tica",
    ],
    curiosities: [
      "Las molÃ©culas de ADN pueden estirarse hasta mÃ¡s de 2 metros en una cÃ©lula",
      "Las enzimas aceleran reacciones quÃ­micas millones de veces",
      "Los plÃ¡sticos son macromolÃ©culas diseÃ±adas por el ser humano",
      "El ozono (Oâ‚ƒ) protege la Tierra de la radiaciÃ³n ultravioleta",
    ],
  },

  celular: {
    title: "Nivel Celular",
    subtitle: "Nivel secundario y universitario",
    content: `
      La cÃ©lula es la unidad bÃ¡sica de la vida. 
      Pueden ser procariotas (bacterias, arqueas) o eucariotas (animales, vegetales, hongos, protozoos). 
      En ellas ocurren procesos vitales como el metabolismo, la divisiÃ³n celular, la transmisiÃ³n genÃ©tica y la comunicaciÃ³n intracelular. 
      Gracias al estudio de las cÃ©lulas, comprendemos fenÃ³menos como la herencia, la inmunidad y las enfermedades.
    `,
    examples: [
      "Las neuronas transmiten impulsos elÃ©ctricos y seÃ±ales quÃ­micas",
      "Las cÃ©lulas musculares contienen proteÃ­nas contrÃ¡ctiles (actina y miosina)",
      "Las cÃ©lulas epiteliales forman barreras protectoras en Ã³rganos",
      "Las cÃ©lulas madre pueden diferenciarse en distintos tipos celulares"
    ],
    curiosities: [
      "El cuerpo humano tiene unas 37 billones de cÃ©lulas",
      "Cada cÃ©lula humana contiene aproximadamente 2 metros de ADN",
      "Las bacterias se dividen rÃ¡pidamente: algunas en 20 minutos",
      "Los virus no son cÃ©lulas, pero infectan cÃ©lulas para reproducirse",

    ],
  },

  macroscopico: {
    title: "Nivel MacroscÃ³pico",
    subtitle: "Nivel secundario y universitario",
    content: `
      Es el nivel donde se observan organismos completos y sus Ã³rganos y sistemas. 
      Los tejidos se agrupan en Ã³rganos, y los Ã³rganos en sistemas que trabajan de manera coordinada. 
      AquÃ­ se estudia la anatomÃ­a, fisiologÃ­a y comportamiento de los seres vivos.
    `,
    examples: [
      "El sistema nervioso procesa informaciÃ³n y coordina respuestas",
      "Los pulmones realizan el intercambio de oxÃ­geno y diÃ³xido de carbono",
      "Los animales y plantas enteros son ejemplos macroscÃ³picos",
      "El sistema digestivo transforma los alimentos en nutrientes"
    ],
    curiosities: [
      "Los elefantes tienen el cerebro mÃ¡s grande de los animales terrestres",
      "El cuerpo humano tiene mÃ¡s de 600 mÃºsculos",
      "Las plantas tambiÃ©n tienen sistemas de transporte: xilema y floema",
    ],
  },

  ecosistemico: {
    title: "Nivel EcosistÃ©mico",
    subtitle: "Nivel secundario y universitario",
    content: `
      Un ecosistema es la interacciÃ³n entre los seres vivos (comunidad) y su medio fÃ­sico (suelo, agua, aire, energÃ­a). 
      Los organismos cumplen roles como productores, consumidores y descomponedores. 
      Los ecosistemas varÃ­an en tamaÃ±o: desde un charco hasta toda la biosfera. 
      En este nivel se estudian cadenas alimenticias, ciclos biogeoquÃ­micos y el impacto humano en la naturaleza.
    `,
    examples: [
      "Un bosque tropical con Ã¡rboles, animales y suelos fÃ©rtiles",
      "Un arrecife de coral con peces, algas y corrientes marinas",
      "Una pradera donde conviven herbÃ­voros, depredadores y pastos",
      "Un desierto con cactus adaptados a la sequÃ­a",
      "Un lago con peces, plantas acuÃ¡ticas y microorganismos"
    ],
    curiosities: [
      "Los arrecifes coralinos albergan mÃ¡s especies que cualquier otro ecosistema marino",
      "El Amazonas produce el 20% del oxÃ­geno del planeta",
      "Los humedales filtran agua y evitan inundaciones",
      "El cambio climÃ¡tico altera ciclos de carbono y agua",
      "Los ecosistemas urbanos tambiÃ©n son objeto de estudio"
    ],
  },
  },
}

const quizQuestions = {
  primaria: [
    {
      question: "Â¿CÃ³mo se llaman las partes mÃ¡s pequeÃ±as de las que estÃ¡n hechas todas las cosas?",
      options: ["MolÃ©culas", "Ãtomos", "CÃ©lulas", "Piedras"],
      correct: 1,
      explanation: "Â¡Correcto! Los Ã¡tomos son como pequeÃ±os bloques de construcciÃ³n que forman todo lo que ves.",
      image: "âš›ï¸",
    },
    {
      question: "Â¿QuÃ© forman dos Ã¡tomos de hidrÃ³geno y uno de oxÃ­geno cuando se juntan?",
      options: ["Aire", "Agua", "Tierra", "Fuego"],
      correct: 1,
      explanation: "Â¡Exacto! Hâ‚‚O es la fÃ³rmula del agua. Â¡Como una receta mÃ¡gica!",
      image: "ðŸ’§",
    },
    {
      question: "Â¿CuÃ¡l de estos puedes ver con tus ojos?",
      options: ["Ãtomos", "Electrones", "Flores", "MolÃ©culas"],
      correct: 2,
      explanation: "Â¡Muy bien! Las flores son parte del nivel macroscÃ³pico que podemos ver.",
      image: "ðŸŒ¸",
    },
    {
      question: "Â¿QuÃ© necesitan las plantas del suelo para crecer?",
      options: ["Juguetes", "Nutrientes", "MÃºsica", "Colores"],
      correct: 1,
      explanation: "Â¡Perfecto! Las plantas toman nutrientes del suelo como su comida.",
      image: "ðŸŒ±",
    },
    {
      question: "Â¿CÃ³mo se llama cuando muchas molÃ©culas se juntan para formar algo grande?",
      options: ["Nivel macroscÃ³pico", "Nivel pequeÃ±o", "Nivel invisible", "Nivel mÃ¡gico"],
      correct: 0,
      explanation: "Â¡Genial! El nivel macroscÃ³pico es todo lo que puedes ver y tocar.",
      image: "ðŸŒ",
    },
  ],
}

// Estado de la aplicaciÃ³n
let currentLevel = "primaria"
let currentSelectedCard = "subatomico"
let currentQuizIndex = 0
let quizScore = 0
let quizStarted = false
let quizCompleted = false
let userAnswers = []

// InicializaciÃ³n
document.addEventListener("DOMContentLoaded", () => {
  initializeApp()
  setupEventListeners()
  updateContent()
  initializeQuiz()
})

function initializeApp() {
  updateContent()
  setupInteractiveElements()
  selectLevelCard("subatomico")
  updateDetailedContent()
}

function setupEventListeners() {
  // Botones de nivel educativo
  document.querySelectorAll(".level-btn").forEach((btn) => {
    btn.addEventListener("click", function () {
      document.querySelectorAll(".level-btn").forEach((b) => b.classList.remove("active"))
      this.classList.add("active")

      currentLevel = this.dataset.level
      updateContent()
      resetQuiz()
      displayCurrentQuestion()
    })
  })

  // Tarjetas de nivel
  document.querySelectorAll(".level-card").forEach((card) => {
    card.addEventListener("click", function () {
      const level = this.dataset.level
      selectLevelCard(level)
    })
  })
}

function selectLevelCard(levelType) {
  document.querySelectorAll(".level-card").forEach((card) => {
    card.classList.remove("active")
  })

  const selectedCard = document.querySelector(`[data-level="${levelType}"]`)
  if (selectedCard) {
    selectedCard.classList.add("active")
  }

  currentSelectedCard = levelType
  updateDetailedContent()
}

function updateDetailedContent() {
  const content = detailedContent[currentLevel]
  const contentTitle = document.querySelector("#content-title")
  const contentBody = document.getElementById("content-body")

  if (content && content[currentSelectedCard]) {
    const levelContent = content[currentSelectedCard]

    if (contentTitle) contentTitle.textContent = levelContent.title

    let htmlContent = levelContent.content

    if (levelContent.examples) {
      htmlContent += `
        <div class="examples-section">
          <h4>âš¡ Ejemplos Importantes</h4>
          <ul>
            ${levelContent.examples.map((example) => `<li>${example}</li>`).join("")}
          </ul>
        </div>
      `
    }

    if (levelContent.curiosities) {
      htmlContent += `
        <div class="curiosities-section">
          <h4>ðŸ’¡ Datos Curiosos</h4>
          <ul>
            ${levelContent.curiosities.map((curiosity) => `<li>${curiosity}</li>`).join("")}
          </ul>
        </div>
      `
    }

    if (contentBody) contentBody.innerHTML = htmlContent
  }
}

function updateContent() {
  updateDetailedContent()
}

function setupInteractiveElements() {
  // Funcionalidad interactiva bÃ¡sica
  console.log("Elementos interactivos configurados")
}

function initializeQuiz() {
  const quizContainer = document.querySelector(".quiz-container")
  if (!quizContainer) return

  resetQuiz()
  displayCurrentQuestion()
}

function resetQuiz() {
  currentQuizIndex = 0
  quizScore = 0
  quizStarted = false
  quizCompleted = false
  userAnswers = []

  updateProgressBar()

  const quizContent = document.getElementById("quizContent")
  const quizResults = document.getElementById("quizResults")

  if (quizContent) quizContent.style.display = "block"
  if (quizResults) quizResults.style.display = "none"
}

function displayCurrentQuestion() {
  const questions = quizQuestions[currentLevel]
  if (!questions || currentQuizIndex >= questions.length) {
    showQuizResults()
    return
  }

  const question = questions[currentQuizIndex]
  const questionEl = document.getElementById("question")
  const optionsEl = document.getElementById("options")
  const nextBtn = document.getElementById("nextBtn")

  if (questionEl) questionEl.textContent = question.question

  if (optionsEl) {
    optionsEl.innerHTML = ""
    question.options.forEach((option, index) => {
      const button = document.createElement("button")
      button.className = "option-btn"
      button.textContent = option
      button.onclick = () => selectAnswer(index)
      optionsEl.appendChild(button)
    })
  }

  if (nextBtn) {
    nextBtn.disabled = true
    nextBtn.textContent = "Siguiente"
  }

  updateProgressBar()
}

function selectAnswer(selectedIndex) {
  const questions = quizQuestions[currentLevel]
  const question = questions[currentQuizIndex]
  const isCorrect = selectedIndex === question.correct
  const optionsEl = document.getElementById("options")
  const nextBtn = document.getElementById("nextBtn")

  // Guardar respuesta del usuario
  userAnswers.push({
    questionIndex: currentQuizIndex,
    selectedAnswer: selectedIndex,
    correctAnswer: question.correct,
    isCorrect: isCorrect,
  })

  // Actualizar puntuaciÃ³n
  if (isCorrect) {
    quizScore++
  }

  // Mostrar feedback visual en los botones
  const answerButtons = optionsEl.querySelectorAll(".option-btn")
  answerButtons.forEach((btn, index) => {
    btn.disabled = true
    if (index === question.correct) {
      btn.classList.add("correct")
    } else if (index === selectedIndex && !isCorrect) {
      btn.classList.add("incorrect")
    }
  })

  if (nextBtn) {
    nextBtn.disabled = false
  }
}

function nextQuestion() {
  currentQuizIndex++
  if (currentQuizIndex < quizQuestions[currentLevel].length) {
    displayCurrentQuestion()
  } else {
    showQuizResults()
  }
}

function updateProgressBar() {
  const questions = quizQuestions[currentLevel]
  const progress = ((currentQuizIndex + 1) / questions.length) * 100
  const progressFill = document.getElementById("progressFill")
  const progressText = document.getElementById("progressText")

  if (progressFill) progressFill.style.width = `${progress}%`
  if (progressText) progressText.textContent = `Pregunta ${currentQuizIndex + 1} de ${questions.length}`
}

function showQuizResults() {
  quizCompleted = true

  const quizContent = document.getElementById("quizContent")
  const quizResults = document.getElementById("quizResults")
  const finalScore = document.getElementById("finalScore")
  const scoreMessage = document.getElementById("scoreMessage")

  if (quizContent) quizContent.style.display = "none"
  if (quizResults) quizResults.style.display = "block"

  if (finalScore) finalScore.textContent = `${quizScore}/${quizQuestions[currentLevel].length}`

}

function restartQuiz() {
  resetQuiz()
  displayCurrentQuestion()
}

// Smooth scroll function
function scrollToSection(sectionId) {
  const section = document.getElementById(sectionId)
  if (section) {
    section.scrollIntoView({
      behavior: "smooth",
      block: "start",
    })
  }
}

// Header scroll effect
window.addEventListener("scroll", () => {
  const header = document.querySelector(".header")
  if (header) {
    if (window.scrollY > 100) {
      header.style.background = "rgba(255, 255, 255, 0.95)"
      header.style.backdropFilter = "blur(20px)"
    } else {
      header.style.background = "rgba(255, 255, 255, 1)"
      header.style.backdropFilter = "none"
    }
  }
})

// Intersection Observer for animations
const observerOptions = {
  threshold: 0.1,
  rootMargin: "0px 0px -50px 0px",
}

const observer = new IntersectionObserver((entries) => {
  entries.forEach((entry) => {
    if (entry.isIntersecting) {
      entry.target.classList.add("fade-in")
    }
  })
}, observerOptions)

// Observe elements for animation
document.addEventListener("DOMContentLoaded", () => {
  const levelCards = document.querySelectorAll(".level-card")
  levelCards.forEach((card) => {
    observer.observe(card)
  })

  const quizSection = document.querySelector(".quiz-section")
  if (quizSection) {
    observer.observe(quizSection)
  }
})

// Keyboard navigation for quiz
document.addEventListener("keydown", (e) => {
  const optionsEl = document.getElementById("options")
  const nextBtn = document.getElementById("nextBtn")

  if (e.key >= "1" && e.key <= "4") {
    const index = Number.parseInt(e.key) - 1
    const buttons = optionsEl?.querySelectorAll(".option-btn")
    if (buttons && buttons[index] && !buttons[index].disabled) {
      selectAnswer(index)
    }
  } else if (e.key === "Enter" && nextBtn && !nextBtn.disabled) {
    nextQuestion()
  }
})

